<aside
  class="fixed lg:relative inset-y-0 left-0 z-30 flex flex-col bg-white border-r border-gray-200 transition-all duration-300 ease-in-out h-full"
  [class.w-64]="isOpen()"
  [class.w-0]="!isOpen()"
  [class.-translate-x-full]="isMobile() && !isOpen()"
  [class.translate-x-0]="!isMobile() || isOpen()"
>
  <div class="flex-1 flex flex-col overflow-hidden">
    <!-- Navigation Menu -->
    <nav class="flex-1 overflow-y-auto py-4 px-3">
      <ul class="space-y-1">
        @for (item of menuItems(); track item.label) {
          <li>
            <!-- Menu Item con hijos -->
            @if (item.children) {
              <div>
                <button
                  (click)="toggleSubmenu(item)"
                  class="w-full flex items-center justify-between px-3 py-2.5 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors group"
                >
                  <div class="flex items-center gap-3">
                    <svg
                      class="w-5 h-5 text-gray-500 group-hover:text-primary-500 transition-colors"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        [attr.d]="item.icon"
                      />
                    </svg>
                    <span class="font-medium text-sm">{{ item.label }}</span>
                  </div>
                  <svg
                    class="w-4 h-4 transition-transform duration-200"
                    [class.rotate-180]="item.expanded"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 9l-7 7-7-7"
                    />
                  </svg>
                </button>

                <!-- Submenu -->
                <div
                  class="overflow-hidden transition-all duration-300 ease-in-out"
                  [class.max-h-0]="!item.expanded"
                  [class.max-h-96]="item.expanded"
                >
                  <ul class="mt-1 ml-8 space-y-1">
                    @for (child of item.children; track child.label) {
                      <li>
                        <a
                          [routerLink]="child.route"
                          routerLinkActive="bg-primary-50 text-primary-600"
                          (click)="onMenuClick()"
                          class="block px-3 py-2 text-sm text-gray-600 rounded-lg hover:bg-gray-100 transition-colors"
                        >
                          {{ child.label }}
                        </a>
                      </li>
                    }
                  </ul>
                </div>
              </div>
            } @else {
              <!-- Menu Item sin hijos -->
              <a
                [routerLink]="item.route"
                routerLinkActive="bg-primary-50 text-primary-600"
                (click)="onMenuClick()"
                class="flex items-center gap-3 px-3 py-2.5 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors group"
              >
                <svg
                  class="w-5 h-5 text-gray-500 group-hover:text-primary-500 transition-colors"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    [attr.d]="item.icon"
                  />
                </svg>
                <span class="font-medium text-sm">{{ item.label }}</span>
              </a>
            }
          </li>
        }
      </ul>
    </nav>

    <!-- User Section (abajo) -->
    <div class="border-t border-gray-200 p-4">
      <div class="flex items-center gap-3">
        <div
          class="w-10 h-10 rounded-full bg-primary-500 flex items-center justify-center text-white font-semibold"
        >
          {{ authService.currentUser()?.username?.charAt(0)?.toUpperCase() }}
        </div>
        <div class="flex-1 min-w-0">
          <p class="text-sm font-medium text-gray-700 truncate text-primary-900">
            {{ authService.currentUser()?.username?.toUpperCase() }}
          </p>
          <p class="text-xs text-gray-500 truncate">
            {{ authService.currentUser()?.role }}
          </p>
        </div>
      </div>
    </div>
  </div>
</aside>
